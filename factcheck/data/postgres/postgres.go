// Package postgres is where code generated by sqlc lives.
// It also provides Postgres connection via NewConn.
package postgres

import (
	"context"
	"fmt"

	"github.com/jackc/pgx/v5"

	"github.com/kaogeek/line-fact-check/factcheck/cmd/api/config"
)

func NewConn(c config.Config) (*pgx.Conn, error) {
	conn, err := pgx.Connect(
		context.Background(),
		fmt.Sprintf(
			"host=%s port=%d user=%s password=%s dbname=%s sslmode=disable",
			c.Postgres.Host, c.Postgres.Port, c.Postgres.User, c.Postgres.Password, c.Postgres.DBName,
		),
	)
	if err != nil {
		return nil, err
	}
	return conn, nil
}
